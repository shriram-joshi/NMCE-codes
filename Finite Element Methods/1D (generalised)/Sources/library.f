module library

    use kind
    use data
    use omp_lib
    implicit none

contains
!***********************************************************************************************************************
! Linear Basis functions
!***********************************************************************************************************************
    subroutine lin_basis_phi1d()
        integer :: i

        ph1=0.0_rk
        dph1=0.0_rk
        do i=1,3
            ph1(1,i) = 1.0_rk - xiarr(i)
            dph1(1,i)= -1.0_rk
            ph1(2,i) = xiarr(i)
            dph1(2,i)= 1.0_rk
        end do
    end subroutine lin_basis_phi1d
!***********************************************************************************************************************
! Linear Basis functions End
!***********************************************************************************************************************

!***********************************************************************************************************************
! Quadratic Basis functions
!***********************************************************************************************************************
    subroutine quad_basis_phi1d()
        implicit none
        integer :: i

        ph1=0.0_rk
        dph1=0.0_rk
        do i=1,3
            ph1(1,i) = 1.0_rk - 3.0_rk*xiarr(i) + 2.0_rk*xiarr(i)*xiarr(i)
            dph1(1,i)= -3.0_rk + 4.0_rk*xiarr(i)
            ph1(2,i) = 4.0_rk*(xiarr(i) - xiarr(i)*xiarr(i))
            dph1(2,i)= 4.0_rk - 8.0_rk*xiarr(i)
            ph1(3,i) = - xiarr(i) + 2.0_rk*xiarr(i)*xiarr(i)
            dph1(3,i)= -1.0_rk+4.0_rk*xiarr(i)
        end do
    end subroutine quad_basis_phi1d
!***********************************************************************************************************************
! Quadratic Basis functions End
!***********************************************************************************************************************
end module library
